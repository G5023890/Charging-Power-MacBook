# Charging Power Menu Bar (macOS)

Лёгкое menu bar приложение для macOS, которое показывает:
- текущую мощность зарядки (`W`) или статус питания (`AC`);
- текущий заряд батареи (`%`);
- `Maximum Capacity` и `Condition` в выпадающем меню.

## Возможности

- Иконка батареи в строке меню с динамическим уровнем.
- Текст рядом с иконкой уменьшен примерно на 10% для более аккуратного вида.
- Пункт меню `Launch at Login`.
- Ручное обновление по кнопке `Update now`.

## Логика обновления данных

Приложение оптимизировано по частоте опроса:
- при питании от сети (`AC`): быстрый опрос каждые `2` секунды (для мощности);
- при работе от батареи: опрос каждые `20` секунд;
- процент заряда (`%`) обновляется раз в `20` секунд;
- `Maximum Capacity` и `Condition` обновляются только:
  - при старте приложения;
  - по нажатию `Update now`.

## Требования

- macOS 13+ (текущая конфигурация проекта);
- Xcode Command Line Tools;
- Swift (через Swift Package Manager).

## Сборка и запуск (локально)

```bash
swift build
swift run
```

## Сборка и установка `.app`

В проекте есть скрипт установки с подписью:

```bash
./scripts/build_and_install_app.sh
```

После выполнения:
- сборка появляется в `dist/PowerApp.app`;
- приложение устанавливается в `/Applications/PowerApp.app`.

## Структура проекта

- `Sources/ChargingPowerMenuBar/ChargingPowerMenuBar.swift` — основная логика menu bar приложения.
- `scripts/build_and_install_app.sh` — сборка, подпись и установка `.app`.
- `Assets/` — иконки приложения (`AppIcon.icns`, `AppIcon.iconset`).

## Примечания

- Если изменили иконки, пересоберите приложение скриптом установки.
- Для обновления `Maximum Capacity` и `Condition` без перезапуска используйте `Update now`.
